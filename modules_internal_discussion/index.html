<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../assets/hyperon-logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>Module Design Discussion - Open Questions - OpenCog Hyperon</title><link rel=stylesheet href=../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#module-design-discussion-open-questions class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> For updates follow <a rel=me href=https://twitter.com/OpenCog> <span class=twemoji> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </span> <strong>OpenCog Hyperon</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="OpenCog Hyperon" class="md-header__button md-logo" aria-label="OpenCog Hyperon" data-md-component=logo> <img src=../assets/hyperon-logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> OpenCog Hyperon </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Module Design Discussion - Open Questions </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=lime aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/trueagi-io/hyperon-experimental title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> trueagi-io/hyperon-experimental </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="OpenCog Hyperon" class="md-nav__button md-logo" aria-label="OpenCog Hyperon" data-md-component=logo> <img src=../assets/hyperon-logo.png alt=logo> </a> OpenCog Hyperon </label> <div class=md-nav__source> <a href=https://github.com/trueagi-io/hyperon-experimental title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> trueagi-io/hyperon-experimental </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../metta/ class=md-nav__link> <span class=md-ellipsis> MeTTa specification </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> MeTTa API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> MeTTa API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../generated/corelib/ class=md-nav__link> <span class=md-ellipsis> Standard library </span> </a> </li> <li class=md-nav__item> <a href=../generated/random/ class=md-nav__link> <span class=md-ellipsis> Random </span> </a> </li> <li class=md-nav__item> <a href=../generated/fileio/ class=md-nav__link> <span class=md-ellipsis> File I/O </span> </a> </li> <li class=md-nav__item> <a href=../generated/json/ class=md-nav__link> <span class=md-ellipsis> JSON </span> </a> </li> <li class=md-nav__item> <a href=../generated/catalog/ class=md-nav__link> <span class=md-ellipsis> Module catalogs </span> </a> </li> <li class=md-nav__item> <a href=../generated/das/ class=md-nav__link> <span class=md-ellipsis> DAS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../minimal-metta/ class=md-nav__link> <span class=md-ellipsis> Minimal Metta specification </span> </a> </li> <li class=md-nav__item> <a href=../modules_dev/ class=md-nav__link> <span class=md-ellipsis> MeTTa modules </span> </a> </li> <li class=md-nav__item> <a href=../das_setup/ class=md-nav__link> <span class=md-ellipsis> DAS setup </span> </a> </li> <li class=md-nav__item> <a href=../rust/hyperon/index.html class=md-nav__link> <span class=md-ellipsis> Rust API Reference </span> </a> </li> <li class=md-nav__item> <a href=../c/index.html class=md-nav__link> <span class=md-ellipsis> C API Reference </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex> <span class=md-ellipsis> Python API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Python API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../reference/atoms/ class=md-nav__link> <span class=md-ellipsis> Atoms </span> </a> </li> <li class=md-nav__item> <a href=../reference/base/ class=md-nav__link> <span class=md-ellipsis> Base </span> </a> </li> <li class=md-nav__item> <a href=../reference/conversion/ class=md-nav__link> <span class=md-ellipsis> Conversion </span> </a> </li> <li class=md-nav__item> <a href=../reference/ext/ class=md-nav__link> <span class=md-ellipsis> Ext </span> </a> </li> <li class=md-nav__item> <a href=../reference/metta/ class=md-nav__link> <span class=md-ellipsis> Metta </span> </a> </li> <li class=md-nav__item> <a href=../reference/module/ class=md-nav__link> <span class=md-ellipsis> Module </span> </a> </li> <li class=md-nav__item> <a href=../reference/runner/ class=md-nav__link> <span class=md-ellipsis> Runner </span> </a> </li> <li class=md-nav__item> <a href=../reference/stdlib/ class=md-nav__link> <span class=md-ellipsis> Stdlib </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../DEVELOPMENT/ class=md-nav__link> <span class=md-ellipsis> Development </span> </a> </li> <li class=md-nav__item> <a href=../CONTRIBUTING/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview-what-does-module-mean class=md-nav__link> <span class=md-ellipsis> Overview: What does Module mean? </span> </a> <nav class=md-nav aria-label="Overview: What does Module mean?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#desiderata class=md-nav__link> <span class=md-ellipsis> Desiderata </span> </a> </li> <li class=md-nav__item> <a href=#mettamod-struct class=md-nav__link> <span class=md-ellipsis> MettaMod struct </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#question-topic-1-importing-linking class=md-nav__link> <span class=md-ellipsis> Question Topic 1: Importing &amp; Linking </span> </a> <nav class=md-nav aria-label="Question Topic 1: Importing & Linking"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#import-as class=md-nav__link> <span class=md-ellipsis> Import As </span> </a> </li> <li class=md-nav__item> <a href=#import-all class=md-nav__link> <span class=md-ellipsis> Import All </span> </a> <nav class=md-nav aria-label="Import All"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#this-current-implementation-some-issues class=md-nav__link> <span class=md-ellipsis> This current implementation some issues </span> </a> </li> <li class=md-nav__item> <a href=#explicit-exports-or-visibility-qualifiers class=md-nav__link> <span class=md-ellipsis> Explicit exports or visibility qualifiers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#import-item class=md-nav__link> <span class=md-ellipsis> Import Item </span> </a> <nav class=md-nav aria-label="Import Item"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tokenizer-entries-dont-always-have-names-to-import class=md-nav__link> <span class=md-ellipsis> Tokenizer entries don't always have names to import </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#question-topic-2-sub-module-version-resolution-discussion class=md-nav__link> <span class=md-ellipsis> Question Topic 2: Sub-Module Version Resolution Discussion </span> </a> <nav class=md-nav aria-label="Question Topic 2: Sub-Module Version Resolution Discussion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#background class=md-nav__link> <span class=md-ellipsis> Background </span> </a> </li> <li class=md-nav__item> <a href=#sub-module-set-satisfiability class=md-nav__link> <span class=md-ellipsis> Sub-Module set satisfiability </span> </a> </li> <li class=md-nav__item> <a href=#module-namespace-scope class=md-nav__link> <span class=md-ellipsis> Module Namespace Scope </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#remaining-implementation-work class=md-nav__link> <span class=md-ellipsis> Remaining implementation work </span> </a> <nav class=md-nav aria-label="Remaining implementation work"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#moduledescriptor-should-be-part-of-pkg_management-features class=md-nav__link> <span class=md-ellipsis> ModuleDescriptor should be part of pkg_management features </span> </a> </li> <li class=md-nav__item> <a href=#try-stripping-but-not-lifting-private-transitive-imports-in-import_all class=md-nav__link> <span class=md-ellipsis> Try stripping but not lifting private transitive imports in import_all </span> </a> </li> <li class=md-nav__item> <a href=#catalog-for-all-python-modules class=md-nav__link> <span class=md-ellipsis> Catalog for All Python modules </span> </a> </li> <li class=md-nav__item> <a href=#atom-serde-serde-format-to-encode-any-structured-data-into-atoms class=md-nav__link> <span class=md-ellipsis> "atom-serde", serde format to encode any structured data into atoms </span> </a> </li> <li class=md-nav__item> <a href=#circular-import-testing-guard-rails class=md-nav__link> <span class=md-ellipsis> Circular-import testing &amp; guard-rails </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/trueagi-io/hyperon-experimental/edit/master/docs/modules_internal_discussion.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/trueagi-io/hyperon-experimental/raw/master/docs/modules_internal_discussion.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=module-design-discussion-open-questions>Module Design Discussion - Open Questions<a class=headerlink href=#module-design-discussion-open-questions title="Permanent link">&para;</a></h1> <h2 id=overview-what-does-module-mean>Overview: What does Module mean?<a class=headerlink href=#overview-what-does-module-mean title="Permanent link">&para;</a></h2> <p>When I began this task, I conflated the design-space of modularity with package management, however the two are separate and distinct. I began the task by designing and implementing a package manager, but the current MeTTa semantics lack the fundamental modularity constructs that are a prerequisite for robust package management.</p> <p>It may seem like a tautology, but I feel it bears repeating that <em>the purpose of modules is modularity.</em> In other words, isolating the implementation and incidental behaviors of some "module" code from other "client" code.</p> <p><strong>Definition</strong>: A module is unit of functionality that can be loaded into a MeTTa runner and used by other MeTTa code without requiring modification of the module, regardless of the location or the format from which the module was loaded.</p> <h3 id=desiderata>Desiderata<a class=headerlink href=#desiderata title="Permanent link">&para;</a></h3> <ul> <li>A module should be able to be loaded and tested independently of client code that might load it</li> <li>A module should express its own sub-module dependencies</li> <li>A module should not rely on the client to import sub-dependencies or configure the environment for the module ("environment" used here in a loose sense, not the Environment object)</li> <li>A corollary to the above is that a module should not be affected by things the client does aside from the interactions through the module's interface. For example, a client shouldn't be able to accidentally break a module's implementation by defining atoms or tokens in the client code. </li> </ul> <p>By analogy, Rust <code>mod</code>s meet these criteria, and C header files do not. Shared libraries, on the other hand, are modules according to the criteria above.</p> <h3 id=mettamod-struct>MettaMod struct<a class=headerlink href=#mettamod-struct title="Permanent link">&para;</a></h3> <p>The [MettaMod] struct essentially takes the place of a "Loading Runner" in the prior code base. The major difference being that the MettaMod continues to exist even after the module loader code has evaluated. More discussion can be found in the "What <em>is</em> a Module?" section of the main module docs.</p> <h2 id=question-topic-1-importing-linking>Question Topic 1: Importing &amp; Linking<a class=headerlink href=#question-topic-1-importing-linking title="Permanent link">&para;</a></h2> <p>To discuss import behavior, we need to discuss 3 distinct cases separately. The cases are:</p> <ul> <li><strong>Import As</strong> <code>import module as name</code></li> <li><strong>Import All (aka import *)</strong> <code>import * from module</code></li> <li><strong>Import Item</strong> <code>import item from module as name</code></li> </ul> <p>In parallel, a discussion on this topic exists here: <a href=https://github.com/trueagi-io/hyperon-experimental/issues/509>https://github.com/trueagi-io/hyperon-experimental/issues/509</a> although this document presently represents a more thorough treatment of the topic.</p> <h3 id=import-as>Import As<a class=headerlink href=#import-as title="Permanent link">&para;</a></h3> <p>This is probably the most straightforward of the three import behaviors. Currently the code registers a new Tokenizer entry in the destination module's Tokenizer with the space of sub-module. This behavior is adequate and does the right thing for allowing the sub-module's space to be accessed within the context of the client module.</p> <p>This is implemented by the [MettaMod::import_dependency_as] method.</p> <p><strong>Outstanding Issue:</strong> This implementation doesn't provide any way to access tokenizer entries that are part of the sub-module.</p> <h3 id=import-all>Import All<a class=headerlink href=#import-all title="Permanent link">&para;</a></h3> <p>Conceptually this operation imports the entire contents of a sub-module into the target module. Another way to think about this is overlaying the space and tokens of the sub-module onto the client module. In practice, given the behavior of the interpreter, the current implementation is a bit convoluted.</p> <p>Currently the implementation leverages the behavior that a nested Space Grounded Atom will behave as an extension of the Space containing it.</p> <p>The import code makes a deep-copy of the sub-module's space, then strips away space atoms that are associated with dependency's own sub-modules (2<sup>nd</sup> order sub-modules), before finally adding the cloned sub-space as a grounded atom into the client's space.</p> <p>After that, the implementation imports the all of the new secondary transitive dependencies into the client, and finally it merges all tokenizer entries from the sub-module into the client.</p> <p>This "import all" behavior is implemented by the [MettaMod::import_all_from_dependency] method.</p> <h4 id=this-current-implementation-some-issues>This current implementation some issues<a class=headerlink href=#this-current-implementation-some-issues title="Permanent link">&para;</a></h4> <ul> <li> <p>Inefficient Space Clone: Deep-cloning the sub-modules's space on every import is costly, considering it should be possible to import functionality by reference. This potentially leads to many copies of the same sub-modules in memory and defeats one of the benefits of modularity. One potential way to fix this it to create a [Space] implementation that I'll call <code>ModuleSpace</code>, which wraps the module's <code>&amp;self</code> space regardless of its underlying type. <code>ModuleSpace</code> holds references to the sub-modules' individual spaces and controls which how the sub-module spaces will be combined. I have not yet tried to implement this so I don't know what other problems may come up.</p> </li> <li> <p>Private Sub-Modules shouldn't be lifted: All transitive dependency sub-modules are lifted into the client scope, including private sub-modules. Assuming we have a fix for the above, addressing this point may be as simple as not stripping and lifting private sub-modules, so that may be an easy fix.</p> </li> <li> <p>Redundant Tokenizer Entries: Currently Tokenizer entries imported from sub-modules may be inaccessible because they are superseded by existing entries in the module's Tokenizer. A partial solution here might be to implement something like a "Layered Tokenizer" as described here: <a href=https://github.com/trueagi-io/hyperon-experimental/issues/408#issuecomment-1839196513>https://github.com/trueagi-io/hyperon-experimental/issues/408#issuecomment-1839196513</a></p> </li> </ul> <h4 id=explicit-exports-or-visibility-qualifiers>Explicit exports or visibility qualifiers<a class=headerlink href=#explicit-exports-or-visibility-qualifiers title="Permanent link">&para;</a></h4> <p>Most languages that support modularity allow a module to declare a subset of the objects as available for export. Sometimes this is done with visibility qualifiers, (for example <code>pub</code> in Rust), or in other situations this is accomplished via the ABI and header files, as with shared libraries imported in C &amp; C++.</p> <p>Explicit control over exports would solve the problem of duplicated or conflicting transitive imports of sub-modules, because private sub-modules would not be exported.</p> <h3 id=import-item>Import Item<a class=headerlink href=#import-item title="Permanent link">&para;</a></h3> <p>The <code>import item from module [as name]</code> is implemented with the [MettaMod::import_item_from_dependency_as] method. However there is no <code>stdlib</code> operation that calls it, so it's currently inaccessible from MeTTa code.</p> <h4 id=tokenizer-entries-dont-always-have-names-to-import>Tokenizer entries don't always have names to import<a class=headerlink href=#tokenizer-entries-dont-always-have-names-to-import title="Permanent link">&para;</a></h4> <p>When we want to import a tokenizer entry from a sub-module, we need a name to refer to it. But currently Tokenizer entries don't have names. By itself, this problem is easy to address, but we should consider our choice of solution in light of the other choices we need to make for the MeTTa language.</p> <p>This issue is discussed in more detail here: <a href=https://github.com/trueagi-io/hyperon-experimental/issues/510>https://github.com/trueagi-io/hyperon-experimental/issues/510</a></p> <p>One solution, as described on github, is to require Tokenizer entries to have corresponding items in the module's Space.</p> <h2 id=question-topic-2-sub-module-version-resolution-discussion>Question Topic 2: Sub-Module Version Resolution Discussion<a class=headerlink href=#question-topic-2-sub-module-version-resolution-discussion title="Permanent link">&para;</a></h2> <h3 id=background>Background<a class=headerlink href=#background title="Permanent link">&para;</a></h3> <p>There are two desiderata which are at odds with each other and must be balanced:</p> <ul> <li> <p><strong>Implementation sub-modules</strong>: We want sub-module dependencies not to interfere with each other as much as is possible. For example, ModA should be able to import ModC, and ModB should be able to import a <em>different</em> version of ModC. This should be allowed as long as both ModA and ModB use ModC within their internal implementation. Within this document I will call this pattern an "Implementation" sub-module.</p> </li> <li> <p><strong>Interface sub-modules</strong> If ModA imports ModC and uses functionality from ModC in its interface, then ClientMod will transitively import ModC when it imports ModA. In effect this means the dependent sub-module's version becomes part of the module's interface. Therefore, within this document, I will call this an "Interface" sub-module. If ClientMod imports ModA and ModB, which both import ModC as an Interface sub-module, then the version (instance) of ModC must be the same between ModA and ModB.</p> </li> </ul> <h3 id=sub-module-set-satisfiability>Sub-Module set satisfiability<a class=headerlink href=#sub-module-set-satisfiability title="Permanent link">&para;</a></h3> <p>The versions of transitive Interface sub-modules must be reconciled such that a given client imports exactly one version of each dependent sub-module, even when that sub-module is shared between two or more other dependents. Finding the compatible module versions is a flavor of the Satisfiability Problem.</p> <p>Reasonably sophisticated package managers such as Cargo include a Satisfiability Solver, which will attempt to find a set of sub-module versions that satisfy the requirements for each client that imports each dependency. I believe we will ultimately want to add a solver to MeTTa too, someday. However this doesn't currently exist. MeTTa as a language is well-suited to implementing a solver.</p> <p>Until we add a solver to the MeTTa Package Manager, the module resolution logic will progress sequentially with no ability to backtrack. This means that we will need to rely on each module's author to manually determine a workable set of sub-module versions for themselves. Then the specific (or narrower) version requirements can be added to the module's [PkgInfo].</p> <p><strong>Current State of the Code:</strong> Version requirements for sub-modules are not yet implemented so this is a non-issue in the present implementation.</p> <h3 id=module-namespace-scope>Module Namespace Scope<a class=headerlink href=#module-namespace-scope title="Permanent link">&para;</a></h3> <p>When a module is loaded, the module's name may be registered in the runner's module namespace, so that subsequent attempts to resolve the same module name elsewhere in the runner will return the already-loaded module as opposed to causing a new instance of the module to be loaded.</p> <p>The question here is which behavior we want for the module namespace:</p> <ul> <li> <p>Proposal A: Global Scope: This means every module is effectively an Interface Module, and only one version of a given module can be loaded in the same runner. This is the approach taken by both Cargo and Python (but for different reasons in each case), and a number of other package managers. However, the reasons that have driven other package managers towards this design don't necessarily apply to MeTTa, and I believe we can support private Implementation sub-modules. Therefore I do not advocate for this design.</p> </li> <li> <p>Proposal B: Conservative Hierarchical Scope: Within this design, each module name only propagates upwards to its client if it needs to, or is explicitly re-exported. This means that Interface modules must be exported or marked some other way. It also complicates the Sat Solver (see above) as it would need to operate over multiple sets with some partial intersections between them. I believe this is probably the "right" design, but also the most work to implement.</p> </li> <li> <p>Proposal C: 2-Layer "Public vs. Private" Scope: This is the way the code currently works. Each imported module may be "Public", in which case it is available by name to all other modules in the runner, or it may be "Private", in which case it is loaded only for the client module that resolves it. This is a "poor man's" version of Proposal B. However, it has many problematic edge cases so I would prefer to implement Proposal B.</p> </li> </ul> <p>For either Proposal B or C, we probably want to add some form of linting / checking, so users don't accidentally shoot themselves in the foot by exporting items that depend on private (Implementation) sub-modules. In other words, public interfaces must not include non-public objects.</p> <p>UPDATE: A version of B is now implemented in the code, with the caveat that nothing is private (visibility constructs don't exist for MeTTa modules at all) but sub-modules can be contained within the namespace of their respective parents.</p> <h2 id=remaining-implementation-work>Remaining implementation work<a class=headerlink href=#remaining-implementation-work title="Permanent link">&para;</a></h2> <p>LP-TODO, search code for remaining TODO comments and collect them here so I can prioritize remaining work</p> <h3 id=moduledescriptor-should-be-part-of-pkg_management-features>ModuleDescriptor should be part of pkg_management features<a class=headerlink href=#moduledescriptor-should-be-part-of-pkg_management-features title="Permanent link">&para;</a></h3> <p>However, we still need a way to globally (within a runner) disambiguate a module. Currently that's done with a ModuleDescriptor. My proposal is to implement the hierarchical module name-space. It's pretty clear that's the direction we want to go, as several open-issues are pointing that way.</p> <p>Then the loaded module table will use full module path instead of ModuleDescriptor, and ModuleDescriptor will be only for modules in a catalog that are not yet loaded.</p> <h3 id=try-stripping-but-not-lifting-private-transitive-imports-in-import_all>Try stripping but not lifting private transitive imports in <code>import_all</code><a class=headerlink href=#try-stripping-but-not-lifting-private-transitive-imports-in-import_all title="Permanent link">&para;</a></h3> <p>In response to the "Private Sub-Modules shouldn't be lifted" section, in a discussino with Vitaly I realized perhaps all of the necessary interfaces to transitive sub-modules might be acomplished within the sub-module's space. So therefore we may be able to get away with stripping but not lifting the private dependencies.</p> <h3 id=catalog-for-all-python-modules>Catalog for All Python modules<a class=headerlink href=#catalog-for-all-python-modules title="Permanent link">&para;</a></h3> <p>Need to implement a ModuleCatalog that publishes all Python modules as MeTTa modules. This will achieve parity with the current implementation and re-enable the practice of using <code>pip</code> to install MeTTa modules. Additionally, we may want to support hierarchical module path imports, so that the MeTTa import operation is able to traverse the python module hierarchy to load and import nested Python modules.</p> <h3 id=atom-serde-serde-format-to-encode-any-structured-data-into-atoms>"atom-serde", serde format to encode any structured data into atoms<a class=headerlink href=#atom-serde-serde-format-to-encode-any-structured-data-into-atoms title="Permanent link">&para;</a></h3> <p>This relates to package management because we want to represent a PkgInfo structure as atoms within MeTTa code. One reusable appraoch to this is to make a serde format that targets atoms. This can then be leveraged for many API structures such as the parse tree, etc.</p> <p>There is a discussion on the topic here: <a href=https://github.com/trueagi-io/hyperon-experimental/issues/455>https://github.com/trueagi-io/hyperon-experimental/issues/455</a></p> <p>Nil's work here <a href=https://github.com/trueagi-io/protobuf-metta>https://github.com/trueagi-io/protobuf-metta</a> and more generally this thread <a href=https://chat.singularitynet.io/chat/pl/u8u9jzrnmp85d8ounmpbmjukyc>https://chat.singularitynet.io/chat/pl/u8u9jzrnmp85d8ounmpbmjukyc</a> has raised the idea that we pursue a format that relies on a structure definition that uses the MeTTa type-system, rather than trying to create a self-describing format.</p> <h3 id=circular-import-testing-guard-rails>Circular-import testing &amp; guard-rails<a class=headerlink href=#circular-import-testing-guard-rails title="Permanent link">&para;</a></h3> <p>I need to make sure the right things happen when circular loading / imports are attempted. More dicussion here: <a href=https://github.com/trueagi-io/hyperon-experimental/pull/580#discussion_r1491178245>https://github.com/trueagi-io/hyperon-experimental/pull/580#discussion_r1491178245</a></p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2023 <a href=https://github.com/trueagi-io/hyperon-experimental target=_blank rel=noopener>OpenCog Hyperon</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/trueagi-io/hyperon-experimental target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> <a href=https://twitter.com/OpenCog target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.e71a0d61.min.js></script> </body> </html>